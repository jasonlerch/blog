{
  "hash": "7a626463d9d4f1127ab77b5e9ffdcc65",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"MINC tools on a new mac\"\ndescription: \"How to install MINC, RMINC, etc. on a new mac\"\nauthor: \"Jason Lerch\"\ndate: \"2025-07-24\"\ncategories: [RMINC]\nformat:\n  html\n---\n\n\n\nGot to play with a new Apple silicon MacBook, which also means installing MINC, RMINC, etc. Since it was useful for me and not always entirely obvious I figured I'd post my instructions here in case it's useful to others. Also brings the blog back to life after a long hiatus.\n\n### Compilers\n\nStep one is to have Apple's developer command line tools. Instructions [here](https://developer.apple.com/xcode/resources/).\n\nYou will also need a fortran compiler, which does not come with the Apple developer tools. Get that [here](https://mac.r-project.org/tools/gfortran-14.2-universal.pkg), and follow the usual instructions for installing a package on a Mac. If you read this page some months/years down the road check [here](https://mac.r-project.org/tools/) for updated versions of the fortran compiler.\n\n### MINC tools\n\nNow it's time to get the MINC tools. Ideally they should be recompiled for Apple silicon (i.e. the M series of CPUs), but for the moment I'm lazy and will rely on Vlad Fonov's (I believe) mamba packages still compiled for Intel. Small speed loss but significant convenience gain, so good enough for me.\n\nFirst step, install mamba/conda via miniforge. All this on the standard Mac terminal. Instructions [here](https://github.com/conda-forge/miniforge), the steps I used below\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n# download\ncurl -L -O \"https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-$(uname)-$(uname -m).sh\"\n\n# and then install\nbash Miniforge3-$(uname)-$(uname -m).sh\n```\n:::\n\n\n\nThis will give some interactive prompts for installing conda/mamba, where the defaults are likely what you want.\n\nThen get the minc toolkit.\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\n# fetch the environment\nmamba create -n minc-forge -c minc-forge minc-toolkit-v2\n\n# and then activate it\nmamba activate minc-forge\n```\n:::\n\n\n\nYou now have a working MINC install, including register and Display.\n\n### RMINC\n\nTo get RMINC going you first need to install R. Find instructions [here](https://cran.r-project.org/bin/macosx/). You'll probably also want RStudio and/or Positron, but those aren't necessary for the remaining installation instructions.\n\nYou'll need a few key packages after R itself has been installed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(c('batchtools', 'dplyr', 'tidyr', 'readr', 'lme4', 'purrr', 'shiny', 'gridBase', 'Rcpp', 'tibble', 'yaml', 'data.tree', 'visNetwork', 'rjson', 'DT', 'rlang', 'bigstatsr', 'devtools'))\n```\n:::\n\n\n\nYou'll also have to install data.tree. The current CRAN package contains a bug that has been fixed upstream but not yet released, so install from there.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"gluc/data.tree\")\n```\n:::\n\n\n\nNow you are ready to install RMINC. To do this the easiest way possible run R in the terminal after `mamba activate minc-forge`. This sets up all the environment variables necessary, which are a bit tricky to get into RStudio hence the recommendation to do this in the terminal without RStudio. You'll also need to compile off the develop branch as some fixes needed for newer versions of R have not migrated to the master branch yet.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"Mouse-Imaging-Centre/RMINC\", ref=\"develop\", upgrade=\"never\")\n```\n:::\n\n\n\nThis should now spit out a bunch of lines of compiler output with the occasional warning. After that, you're all set for RMINC. You'll also want MRIcrotome, installable like so:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"Mouse-Imaging-Centre/MRIcrotome\")\n```\n:::\n\n\n\nAnd that's it. Now RMINC and MRIcrotome should be accessible using standard library calls, whether run through the shell or in RStudio. There are likely many more R packages that you will want, but those can be obtained through standard R ways.\n\nLet me know of any errors or missed instructions.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}